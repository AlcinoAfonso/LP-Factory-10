{
  "meta": {
    "datetime": "02/01/2026 17:00",
    "origin": "ajuste pontual",
    "scope": "documentacao",
    "execution_mode": "github_actions",
    "target_doc": "docs/base-tecnica.md",
    "warnings": []
  },
  "ops": [
    {
      "id": "A1",
      "doc_path": "docs/base-tecnica.md",
      "op": "replace_section",
      "target": "0.1",
      "content": "0.1 Cabeçalho\n• Data da última atualização: 30/12/2025\n• Documento: LP Factory 10 — Base Técnica v1.9.5 — Referência normativa ativa\n"
    },
    {
      "id": "A2",
      "doc_path": "docs/base-tecnica.md",
      "op": "replace_section",
      "target": "2.1",
      "content": "2.1 Framework\n• Next.js 16.1.1 (App Router, SSR, Server Components)\n• React 19.2.x + React DOM 19.2.x\n• TypeScript 5.5.4 (strict)\n• Node.js 22.x\n• Package manager: npm\n• Lockfile canônico: package-lock.json (deve ficar commitado e alinhado ao package.json)\n• Next 16.x prioriza Turbopack; evitar customizações via webpack() no next.config quando possível (preferir alias via tsconfig.json > paths)\n"
    },
    {
      "id": "A3",
      "doc_path": "docs/base-tecnica.md",
      "op": "replace_section",
      "target": "3.4",
      "content": "3.4 CI/Lint (Bloqueios)\n• Validação por PR + preview de deploy (Vercel)\n• Bloqueio de segurança: impedir padrões de implicit flow em client/UI (access_token, refresh_token, setSession, getSessionFromUrl)\n• Regra: verifyOtp() só pode existir em app/auth/confirm/**\n• Regra de merge (mínimo): validação automática ok + preview ok + smoke de acesso (login/logout/reset de senha/navegação pós-login)\n• Regra: antes de merge, seguir obrigatoriamente o checklist da seção 7 (anti-regressão)\n"
    },
    {
      "id": "A4",
      "doc_path": "docs/base-tecnica.md",
      "op": "replace_section",
      "target": "3.13",
      "content": "3.13 Compatibilidade Next.js 15 / React 19\n• Contexto: notas de compatibilidade da migração Next.js 15 → Next.js 16 (estado atual: Next.js 16.1.1 + React 19.x)\n• cookies() e headers() podem exigir await em SSR/Server Components (usar async quando necessário)\n• params/searchParams podem exigir await em algumas rotas/pages (usar async quando necessário)\n• Rotas que dependem de sessão/cookies devem ser dinâmicas (evitar cache entre usuários)\n• Next 16.x prioriza Turbopack; evitar webpack() custom no next.config quando possível\n• Em novos códigos de forms/Server Actions: preferir useActionState (não usar useFormState)\n"
    },
    {
      "id": "B1",
      "doc_path": "docs/base-tecnica.md",
      "op": "insert_after_section",
      "anchor": "3.4",
      "content": "3.4.1 Manutenção (Upgrade Next.js + lockfile)\n• Objetivo: atualizar Next.js + eslint-config-next para a versão informada e manter lockfile canônico versionado (npm)\n• Regra: lockfile canônico é package-lock.json (deve ficar commitado e alinhado ao package.json)\n• Setup: Node.js 22.x\n• Regra: se existir package-lock.json, usar instalação reprodutível; se não existir, gerar e commitar package-lock.json\n• Lint: non-blocking em manutenção (não deve impedir o bump/lockfile)\n• Build: blocking (não publicar se build falhar)\n• Regra: commitar alterações somente quando houver mudanças detectadas\n"
    },
    {
      "id": "C1",
      "doc_path": "docs/base-tecnica.md",
      "op": "insert_after_heading",
      "heading": "8. Changelog",
      "content": "v1.9.5 (30/12/2025) — Upgrade Next.js 16.1.1\n• Atualizado 0.1 Cabeçalho: data/versão para v1.9.5.\n• Atualizado 2.1 Framework: Next.js 16.1.1 + lockfile canônico (package-lock.json, npm) + contexto Turbopack.\n• Atualizado 3.4 CI/Lint (Bloqueios): bloqueios de segurança (implicit flow + allowlist de verifyOtp) e smoke mínimo antes de merge.\n• Atualizado 3.13 Compatibilidade Next.js 15 / React 19: registrado estado atual em Next.js 16.1.1 e impactos práticos (await e build).\n• Adicionada 3.4.1: manutenção de upgrade + lockfile canônico.\n"
    }
  ],
  "rules": {
    "fail_if_anchor_missing": true,
    "fail_if_target_missing": true,
    "fail_if_section_already_exists_on_insert": true,
    "fail_if_ambiguous_match": true,
    "no_renumber": true,
    "no_reformat": true,
    "no_out_of_scope_changes": true
  }
}
